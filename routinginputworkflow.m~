% Fine resolution basin mask (at the DEM resolution)
% Coarse resolution basin mask (at the VIC model resolution)

[fine,R] = arcgridread('/Users/jschapMac/Desktop/UpperKaweah/upper_kaweah.asc');
[coarse,R] = arcgridread('/Users/jschapMac/Desktop/UpperKaweah/upper_kaweah_coarse.asc');
 
% Generalized version
fract = NaN(size(coarse));
for i=1:11
    for j=1:18
        fract(i,j) = 1;
    end
end

% number of fine grid cells within one coarse grid cell (64)
coarse_res = 1/8;
fine_res = 1/64;
nfine = (coarse_res/fine_res)^2;

% assumed to be squares...

i=1;j=1;
count = 0;
for m=1:sqrt(nfine)
    for n=1:sqrt(nfine)
        count = count + fine(m,n);
    end
end
fract(i,j) = count;
        
%%%%%% very simple version
i=1;j=1;
count = 0;
for m=1:8
    for n=1:8
        count = count + fine(m,n);
    end
end
fract(i,j) = count;

i=1;j=2;
count = 0;
for m=1:8
    for n=1:8
        count = count + fine(m,n);
    end
end
fract(i,j) = count;





inpolygon(basin.Y, basin.Y)

% Name and location of basin shapefile
shpname = '/Users/jschapMac/Desktop/UpperKaweah/upper_kaweah.shp';

% Name and location of soil parameter file
soilname = '/Users/jschapMac/Desktop/UpperKaweah/soils_spec.KAWEAH';

basin = shaperead(shpname); % polygon
soil = load(soilname); % grid cells

slat = soil(:,3);
slon = soil(:,4);

% This makes a raster from X Y data.
[Z,R] = vec2mtx(basin.Y, basin.X, 1);

% Compute the portion of the grid cell that is in the basin:
